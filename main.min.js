var a=require('jsonwebtoken'),b=require('../models/user'),c=(async (A,_,B)=>{try{const{id:C}=A.params;const _b=await b.findById(C);console.log(_b);if(!_b)return _.status(404).json({message:'User no found'});if(_b.rol=='admin')B();else return _.status(403).json({message:'Usuario no autorizado'})}catch(_a){return _.status(401).json({message:'Usuario no autorizado'})}});module.exports={verifyRole:c};
